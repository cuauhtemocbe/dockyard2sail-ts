#!/bin/sh

echo "ğŸ” Running pre-merge validations..."

# Check if we're merging into main branch
current_branch=$(git rev-parse --abbrev-ref HEAD)

if [ "$current_branch" = "main" ]; then
    echo "ğŸ›¡ï¸  Running full validation on merge to main..."
    
    # Run validation script
    if ! ./scripts/validate.sh; then
        echo "âŒ Pre-merge validation failed"
        exit 1
    fi
    
    echo "âœ… Pre-merge validation passed"
else
    echo "ğŸ“ Running basic checks on feature branch merge..."
    
    # Run type checking only for feature branches
    if ! pnpm run typecheck; then
        echo "âŒ TypeScript type checking failed"
        exit 1
    fi
    
    echo "âœ… Basic validation passed"
fi
